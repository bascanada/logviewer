clients:
  local-splunk:
    type: splunk
    options:
      url: https://localhost:8089/services
      headers:
        authorization: "Basic YWRtaW46cGFzc3dvcmQ="
      searchBody:
        output_mode: json

  local-ssh:
    type: ssh
    options:
      user: testuser
      addr: 127.0.0.1:2222
      privateKey: integration/ssh/id_rsa

  local-opensearch:
    type: opensearch
    options:
      endpoint: http://localhost:9200

  local-docker:
    type: docker
    options:
      host: unix:///var/run/docker.sock

  local-k3s:
    type: k8s
    options:
      kubeConfig: integration/k8s/k3s.yaml

  local-cloudwatch:
    type: cloudwatch
    options:
      region: us-east-1
      endpoint: http://localhost:4566

searches:
  demo-file-regex:
    fieldExtraction:
      groupRegex: '.*(?P<level>INFO|WARN|ERROR|DEBUG).*---\s*\[(?P<thread>[^\]]+)\]'
      timestampRegex: '^(\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2}(\.\d+)?)'
      kvRegex: '([A-Z]{2,}):\s([^\s,]+)'
  pretty-print:
    printerOptions:
      messageRegex: '^[\s\S]*[\w.$-]+\s+:\s*(.*)$'
      template: '[{{.Timestamp.Format "15:04:05" }}] [{{.Fields.level}}] {{.Message}}'

contexts:
  local-test:
    client: local
    searchInherit: ["demo-file-regex"]
    search:
      fields: {}
      options:
        cmd: 'tail -n {{or .Size.Value 200}} integration/logs/app.log'

  local-test-2:
    client: local
    searchInherit: ["demo-file-regex"]
    search:
      fields: {}
      options:
        cmd: 'tail -n {{or .Size.Value 200}} integration/logs/app.log'

  splunk-app-logs:
    client: local-splunk
    searchInherit: []
    search:
      options:
        index: main

  ssh-app-log:
    client: local-ssh
    searchInherit: ["demo-file-regex"]
    search:
      fields: {}
      options:
        cmd: 'tail -n {{or .Size.Value 200}} app.log'

  opensearch-app-logs:
    client: local-opensearch
    searchInherit: []
    search:
      fields: {}
      options:
        index: app-logs

  docker-sample-container:
    client: local-docker
    searchInherit: []
    search:
      fields: {}
      options:
        container: ${DOCKER_CID}
        showStdout: true
        showStderr: true
        timestamps: true
        details: false

  k3s-coredns:
    client: local-k3s
    searchInherit: []
    search:
      fields: {}
      options:
        namespace: kube-system
        pod: ${COREDNS_POD}
        timestamp: true

  cloudwatch-app-logs:
    client: local-cloudwatch
    searchInherit: []
    search:
      fields: {}
      options:
        logGroupName: my-app-logs
        useInsights: false

  # SSH test context that disables PTY to force raw output (useful for network devices)
  ssh-no-pty-test:
    client: local-ssh
    description: "SSH test with disablePTY=true to get raw output (no pagination)"
    searchInherit: ["demo-file-regex"]
    search:
      fields: {}
      options:
        cmd: "cat app.log"
        disablePTY: true

