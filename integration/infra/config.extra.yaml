contexts:
  extra-payment:
    client: sim-splunk
    searchInherit: ["json-structured","transaction-view"]
    search:
      fields: {}
      options:
        index: main
        search: 'sourcetype=json app="payment-service" level=ERROR'

  # ============================================
  # Recursive Filter Test Contexts
  # ============================================

  # Test 1: Splunk - Simple OR filter (ERROR OR WARN logs)
  splunk-errors-or-warns:
    client: sim-splunk
    description: "Splunk: ERROR or WARN level logs (tests OR filter)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      range:
        last: 1h
      options:
        index: main
      filter:
        logic: OR
        filters:
          - field: level
            value: ERROR
          - field: level
            value: WARN

  # Test 2: Splunk - Nested filter: (ERROR OR WARN) AND app=log-generator
  splunk-critical:
    client: sim-splunk
    description: "Splunk: Critical logs (tests nested AND/OR)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      range:
        last: 1h
      options:
        index: main
      filter:
        logic: AND
        filters:
          - logic: OR
            filters:
              - field: level
                value: ERROR
              - field: level
                value: WARN
          - field: app
            value: log-generator

  # Test 3: Splunk - NOT filter (exclude DEBUG logs)
  splunk-no-debug:
    client: sim-splunk
    description: "Splunk: All logs except DEBUG (tests NOT filter)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      range:
        last: 1h
      options:
        index: main
      filter:
        logic: NOT
        filters:
          - field: level
            value: DEBUG

  # Test 4: OpenSearch - OR filter for ERROR or WARN
  opensearch-errors-or-warns:
    client: sim-opensearch
    description: "OpenSearch: ERROR or WARN level logs"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      range:
        last: 1h
      options:
        index: app-logs
      filter:
        logic: OR
        filters:
          - field: level
            op: match
            value: ERROR
          - field: level
            op: match
            value: WARN

  # Test 5: OpenSearch - Complex nested: (level=ERROR) OR (level=WARN)
  opensearch-complex:
    client: sim-opensearch
    description: "OpenSearch: Complex nested filter - ERROR or WARN logs"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      range:
        last: 1h
      options:
        index: app-logs
      filter:
        logic: AND
        filters:
          - field: app
            op: match
            value: log-generator
          - logic: OR
            filters:
              - field: level
                op: match
                value: ERROR
              - field: level
                op: match
                value: WARN

  # Test 6: OpenSearch - Regex filter with OR
  opensearch-regex-errors:
    client: sim-opensearch
    description: "OpenSearch: Regex match for error patterns"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      range:
        last: 1h
      options:
        index: app-logs
      filter:
        logic: OR
        filters:
          - field: message
            op: regex
            value: ".*[Ee]rror.*"
          - field: message
            op: regex
            value: ".*[Ff]ail.*"

  # Test 7: K8s - Client-side filtering with OR (tests reader.go Match)
  k8s-errors-or-warns:
    client: sim-k8s
    description: "K8s: ERROR or WARN logs (tests client-side OR filter)"
    searchInherit: ["k8s-log-extraction", "transaction-view"]
    search:
      options:
        namespace: default
        labelSelector: "app=payment-processor"
        timestamp: true
      filter:
        logic: OR
        filters:
          - field: level
            value: ERROR
          - field: level
            value: WARN

  # Test 8: K8s - NOT DEBUG (client-side NOT filter)
  k8s-no-debug:
    client: sim-k8s
    description: "K8s: All logs except DEBUG (tests client-side NOT filter)"
    searchInherit: ["k8s-log-extraction", "transaction-view"]
    search:
      options:
        namespace: default
        labelSelector: "app=payment-processor"
        timestamp: true
      filter:
        logic: NOT
        filters:
          - field: level
            value: DEBUG

  # Test 9: Combined legacy fields + new filter
  splunk-legacy-plus-filter:
    client: sim-splunk
    description: "Splunk: Legacy fields + new OR filter combined"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      fields:
        app: log-generator
      range:
        last: 1h
      options:
        index: main
      filter:
        logic: OR
        filters:
          - field: level
            value: ERROR
          - field: level
            value: WARN

  # Test 10: Wildcard operator test
  # Note: OpenSearch wildcard on text fields requires .keyword suffix
  opensearch-wildcard:
    client: sim-opensearch
    description: "OpenSearch: Wildcard app name filter"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      range:
        last: 1h
      options:
        index: app-logs
      filter:
        field: app.keyword
        op: wildcard
        value: "log-*"

  # Test 11: Exists operator test
  splunk-has-trace:
    client: sim-splunk
    description: "Splunk: Only logs with trace_id field"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      range:
        last: 1h
      options:
        index: main
      filter:
        field: trace_id
        op: exists

  # ============================================
  # HL-Compatible Query Syntax Test Contexts
  # ============================================
  # These contexts test the new hl-compatible query syntax features:
  # - Comparison operators (>, >=, <, <=)
  # - Negation operators (!=, !~=)
  # - The Negate field in Filter struct

  # Test 12: Splunk - Greater than comparison (latency > 1000ms)
  splunk-slow-requests:
    client: sim-splunk
    description: "Splunk: Slow requests with latency > 1000ms (tests gt operator)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: main
      filter:
        field: latency_ms
        op: gt
        value: "1000"

  # Test 13: Splunk - Greater or equal comparison (latency >= 500ms)
  splunk-latency-gte:
    client: sim-splunk
    description: "Splunk: Requests with latency >= 500ms (tests gte operator)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: main
      filter:
        field: latency_ms
        op: gte
        value: "500"

  # Test 14: Splunk - Less than comparison (latency < 100ms)
  splunk-fast-requests:
    client: sim-splunk
    description: "Splunk: Fast requests with latency < 100ms (tests lt operator)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: main
      filter:
        field: latency_ms
        op: lt
        value: "100"

  # Test 15: Splunk - Negation (level != DEBUG)
  splunk-not-debug-negate:
    client: sim-splunk
    description: "Splunk: All logs except DEBUG using Negate (tests negate field)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: main
      filter:
        field: level
        op: equals
        value: DEBUG
        negate: true

  # Test 16: Splunk - Not regex (message !~= .*success.*)
  splunk-not-success:
    client: sim-splunk
    description: "Splunk: Logs without 'success' in message (tests negate + regex)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: main
      filter:
        field: message
        op: regex
        value: ".*success.*"
        negate: true

  # Test 17: OpenSearch - Greater than comparison
  opensearch-slow-requests:
    client: sim-opensearch
    description: "OpenSearch: Slow requests with latency > 1000ms"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: app-logs
      filter:
        field: latency_ms
        op: gt
        value: "1000"

  # Test 18: OpenSearch - Less than or equal comparison
  opensearch-latency-lte:
    client: sim-opensearch
    description: "OpenSearch: Requests with latency <= 200ms"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: app-logs
      filter:
        field: latency_ms
        op: lte
        value: "200"

  # Test 19: OpenSearch - Negation (exclude INFO level)
  # Note: Using 'match' op instead of 'equals' because OpenSearch text fields
  # are analyzed, and 'term' query (used for equals) requires exact token match
  opensearch-not-info:
    client: sim-opensearch
    description: "OpenSearch: All logs except INFO level (tests negate)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: app-logs
      filter:
        field: level
        op: match
        value: INFO
        negate: true

  # Test 20: Complex - Comparison with OR
  splunk-critical-slow:
    client: sim-splunk
    description: "Splunk: ERROR logs OR slow requests (latency > 1000)"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: main
      filter:
        logic: OR
        filters:
          - field: level
            value: ERROR
          - field: latency_ms
            op: gt
            value: "1000"

  # Test 21: Complex - Negation with AND
  splunk-errors-not-payment:
    client: sim-splunk
    description: "Splunk: ERROR logs but NOT from payment-service"
    searchInherit: ["json-structured", "transaction-view"]
    search:
      options:
        index: main
      filter:
        logic: AND
        filters:
          - field: level
            value: ERROR
          - field: app
            op: equals
            value: payment-service
            negate: true

  # ============================================
  # NOTE: HL Engine test contexts are in config.hl-benchmark.yaml
  # Run with: LOGVIEWER_CONFIG="integration/config.hl-benchmark.yaml" ./build/logviewer query log -i local-hl
  # ============================================